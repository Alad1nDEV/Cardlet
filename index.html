<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Obr√°zkov√© flash-karty</title>
<style>
 body{font-family:Arial,Helvetica,sans-serif;display:flex;flex-direction:column;align-items:center;
      gap:18px;margin:0;padding:40px;background:#f0f0f0}
 h1{margin:0;font-size:2rem}
 #stats{font-size:1.1rem}
 #card{width:300px;height:400px;perspective:1000px;display:none}
 .inner{width:100%;height:100%;position:relative;transform-style:preserve-3d;transition:transform .6s}
 .flipped{transform:rotateY(180deg)}
 .side{position:absolute;inset:0;border-radius:12px;box-shadow:0 4px 10px rgba(0,0,0,.25);
       backface-visibility:hidden;display:flex;justify-content:center;align-items:center;
       background:#fff;padding:20px;box-sizing:border-box}
 .side img{max-width:100%;max-height:100%;border-radius:10px}
 .back{transform:rotateY(180deg);font-size:1.3em;text-align:center}
 #ctrl{display:flex;gap:25px}
 button{font-size:2rem;padding:8px 22px;border:none;border-radius:8px;cursor:pointer;color:#fff;
        transition:transform .15s}
 button:active{transform:scale(.88)}
 .wrong{background:#f44336}
 .right{background:#4caf50}
 .alt{background:#2196f3}
 .small{font-size:.9rem}
</style>
</head>
<body>

<h1>Obr√°zkov√© flash-karty</h1>

<input type="file" id="file" accept=".csv">
<button id="btnReset" class="small">Reset</button>
<div id="stats"></div>

<div id="card">
  <div class="inner" id="inner">
    <div class="side front"><img id="pic" alt=""></div>
    <div class="side back" id="title"></div>
  </div>
</div>

<div id="ctrl" style="display:none">
  <button class="wrong" id="btnWrong">‚úñ</button>
  <button class="alt"  id="btnAlt">üîÑ</button>
  <button class="right" id="btnRight">‚úî</button>
</div>

<script>
/* === v√Ωchoz√≠ uk√°zkov√° data ============================================== */
const DEFAULT_CSV = `kr√°snooƒçko,Euglena,https://commons.wikimedia.org/wiki/Special:FilePath/Euglena.jpg
trepka,Paramecium,https://commons.wikimedia.org/wiki/Special:FilePath/Paramecium.jpg
nezmar hnƒõd√Ω,Hydra oligactis,https://commons.wikimedia.org/wiki/Special:FilePath/Hydra_oligactis.jpg
tal√≠≈ôovka u≈°at√°,Aurelia aurita,https://commons.wikimedia.org/wiki/Special:FilePath/Aurelia_aurita.jpg
kor√°l ƒçerven√Ω,Corallium rubrum,https://commons.wikimedia.org/wiki/Special:FilePath/Corallium_rubrum.jpg
sasanka ko≈àsk√°,Actinia equina,https://commons.wikimedia.org/wiki/Special:FilePath/Actinia_equina.jpg
plo≈°tƒõnka ml√©ƒçn√°,Dugesia lactea,https://commons.wikimedia.org/wiki/Special:FilePath/Dugesia_lactea.jpg
motolice jatern√≠,Fasciola hepatica,https://commons.wikimedia.org/wiki/Special:FilePath/Fasciola_hepatica.jpg
tasemnice bezbrann√°,Taenia saginata,https://commons.wikimedia.org/wiki/Special:FilePath/Taenia_saginata.jpg
≈°krkavka dƒõtsk√°,Ascaris lumbricoides,https://commons.wikimedia.org/wiki/Special:FilePath/Ascaris_lumbricoides.jpg
roup dƒõtsk√Ω,Enterobius vermicularis,https://commons.wikimedia.org/wiki/Special:FilePath/Enterobius_vermicularis.jpg
hlem√Ω≈æƒè zahradn√≠,Helix pomatia,https://commons.wikimedia.org/wiki/Special:FilePath/Helix_pomatia.jpg
plovatka bahenn√≠,Lymnaea stagnalis,https://commons.wikimedia.org/wiki/Special:FilePath/Lymnaea_stagnalis.jpg
≈°keble rybniƒçn√°,Anodonta cygnea,https://commons.wikimedia.org/wiki/Special:FilePath/Anodonta_cygnea.jpg
velevrub mal√≠≈ôsk√Ω,Unio pictorum,https://commons.wikimedia.org/wiki/Special:FilePath/Unio_pictorum.jpg
s√©pie obecn√°,Sepia officinalis,https://commons.wikimedia.org/wiki/Special:FilePath/Sepia_officinalis.jpg
≈æ√≠≈æala obecn√°,Lumbricus terrestris,https://commons.wikimedia.org/wiki/Special:FilePath/Lumbricus_terrestris.jpg
pijavka ko≈àsk√°,Haemopis sanguisuga,https://commons.wikimedia.org/wiki/Special:FilePath/Haemopis_sanguisuga.jpg
≈°t√≠r k√Ωlnat√Ω,Euscorpius carpathicus,https://commons.wikimedia.org/wiki/Special:FilePath/Euscorpius_carpathicus.jpg
k≈ôi≈æ√°k obecn√Ω,Araneus diadematus,https://commons.wikimedia.org/wiki/Special:FilePath/Araneus_diadematus.jpg
vodouch st≈ô√≠b≈ôit√Ω,Argyroneta aquatica,https://commons.wikimedia.org/wiki/Special:FilePath/Argyroneta_aquatica.jpg
sek√°ƒç dom√°c√≠,Phalangium opilio,https://commons.wikimedia.org/wiki/Special:FilePath/Phalangium_opilio.jpg
kl√≠≈°tƒõ obecn√©,Ixodes ricinus,https://commons.wikimedia.org/wiki/Special:FilePath/Ixodes_ricinus.jpg
hrotnatka pr≈Øhledn√°,Daphnia pulex,https://commons.wikimedia.org/wiki/Special:FilePath/Daphnia_pulex.jpg
buchanka obecn√°,Cyclops strenuus,https://commons.wikimedia.org/wiki/Special:FilePath/Cyclops_strenuus.jpg
rak ≈ô√≠ƒçn√≠,Astacus astacus,https://commons.wikimedia.org/wiki/Special:FilePath/Astacus_astacus.jpg
langusta obecn√°,Palinurus vulgaris,https://commons.wikimedia.org/wiki/Special:FilePath/Palinurus_vulgaris.jpg
mnohono≈æka zemn√≠,Julus terrestris,https://commons.wikimedia.org/wiki/Special:FilePath/Julus_terrestris.jpg
stono≈æka ≈°kvorov√°,Lithobius forficatus,https://commons.wikimedia.org/wiki/Special:FilePath/Lithobius_forficatus.jpg
≈°kvor obecn√Ω,Forficula auricularia,https://commons.wikimedia.org/wiki/Special:FilePath/Forficula_auricularia.jpg
≈°v√°b obecn√Ω,Blatta orientalis,https://commons.wikimedia.org/wiki/Special:FilePath/Blatta_orientalis.jpg
cvrƒçek poln√≠,Gryllus campestris,https://commons.wikimedia.org/wiki/Special:FilePath/Gryllus_campestris.jpg
krtono≈æka obecn√°,Gryllotalpa gryllotalpa,https://commons.wikimedia.org/wiki/Special:FilePath/Gryllotalpa_gryllotalpa.jpg
saranƒçe modrok≈ô√≠dl√°,Oedipoda caerulescens,https://commons.wikimedia.org/wiki/Special:FilePath/Oedipoda_caerulescens.jpg
rumƒõnice pospoln√°,Pyrrhocoris apterus,https://commons.wikimedia.org/wiki/Special:FilePath/Pyrrhocoris_apterus.jpg
roh√°ƒç obecn√Ω,Lucanus cervus,https://commons.wikimedia.org/wiki/Special:FilePath/Lucanus_cervus.jpg
chroust obecn√Ω,Melolontha melolontha,https://commons.wikimedia.org/wiki/Special:FilePath/Melolontha_melolontha.jpg
nosoro≈æ√≠k kapuc√≠nek,Oryctes nasicornis,https://commons.wikimedia.org/wiki/Special:FilePath/Oryctes_nasicornis.jpg
st≈ôevl√≠k ko≈æit√Ω,Carabus coriaceus,https://commons.wikimedia.org/wiki/Special:FilePath/Carabus_coriaceus.jpg
st≈ôevl√≠k fialov√Ω,Carabus violaceus,https://commons.wikimedia.org/wiki/Special:FilePath/Carabus_violaceus.jpg
hroba≈ô√≠k obecn√Ω,Nicrophorus vespillo,https://commons.wikimedia.org/wiki/Special:FilePath/Nicrophorus_vespillo.jpg
tesa≈ô√≠k obecn√Ω,Cerambyx cerdo,https://commons.wikimedia.org/wiki/Special:FilePath/Cerambyx_cerdo.jpg
potemn√≠k mouƒçn√Ω,Tenebrio molitor,https://commons.wikimedia.org/wiki/Special:FilePath/Tenebrio_molitor.jpg
ko≈æojed obecn√Ω,Dermestes lardarius,https://commons.wikimedia.org/wiki/Special:FilePath/Dermestes_lardarius.jpg
svƒõtlu≈°ka men≈°√≠,Lamprohiza splendidula,https://commons.wikimedia.org/wiki/Special:FilePath/Lamprohiza_splendidula.jpg
lumek velk√Ω,Ichneumon eumerus,https://commons.wikimedia.org/wiki/Special:FilePath/Ichneumon_eumerus.jpg
sr≈°e≈à obecn√°,Vespa crabro,https://commons.wikimedia.org/wiki/Special:FilePath/Vespa_crabro.jpg
p≈ô√°stevn√≠k medvƒõd√≠,Arctia caja,https://commons.wikimedia.org/wiki/Special:FilePath/Arctia_caja.jpg
stu≈ækonoska modr√°,Catocala fraxini,https://commons.wikimedia.org/wiki/Special:FilePath/Catocala_fraxini.jpg
li≈°aj pav√≠ oko,Smerinthus ocellata,https://commons.wikimedia.org/wiki/Special:FilePath/Smerinthus_ocellata.jpg
baboƒçka admir√°l,Vanessa atalanta,https://commons.wikimedia.org/wiki/Special:FilePath/Vanessa_atalanta.jpg
baboƒçka osikov√°,Nymphalis antiopa,https://commons.wikimedia.org/wiki/Special:FilePath/Nymphalis_antiopa.jpg
baboƒçka kop≈ôivov√°,Aglais urticae,https://commons.wikimedia.org/wiki/Special:FilePath/Aglais_urticae.jpg
baboƒçka pav√≠ oko,Aglais io,https://commons.wikimedia.org/wiki/Special:FilePath/Aglais_io.jpg
bƒõl√°sek zeln√Ω,Pieris brassicae,https://commons.wikimedia.org/wiki/Special:FilePath/Pieris_brassicae.jpg
bƒõl√°sek ≈ôe≈ôichov√Ω,Pieris rapae,https://commons.wikimedia.org/wiki/Special:FilePath/Pieris_rapae.jpg
otak√°rek fenyklov√Ω,Papilio machaon,https://commons.wikimedia.org/wiki/Special:FilePath/Papilio_machaon.jpg
batolec duhov√Ω,Apatura iris,https://commons.wikimedia.org/wiki/Special:FilePath/Apatura_iris.jpg
tiplice luƒçn√≠,Tipula paludosa,https://commons.wikimedia.org/wiki/Special:FilePath/Tipula_paludosa.jpg
kom√°r pisklav√Ω,Culex pipiens,https://commons.wikimedia.org/wiki/Special:FilePath/Culex_pipiens.jpg
octomilka obecn√°,Drosophila melanogaster,https://commons.wikimedia.org/wiki/Special:FilePath/Drosophila_melanogaster.jpg
klo≈° jelen√≠,Lipoptena cervi,https://commons.wikimedia.org/wiki/Special:FilePath/Lipoptena_cervi.jpg
moucha dom√°c√≠,Musca domestica,https://commons.wikimedia.org/wiki/Special:FilePath/Musca_domestica.jpg
ov√°d bzuƒçiv√Ω,Tabanus bovinus,https://commons.wikimedia.org/wiki/Special:FilePath/Tabanus_bovinus.jpg
blecha obecn√°,Pulex irritans,https://commons.wikimedia.org/wiki/Special:FilePath/Pulex_irritans.jpg
hvƒõzdice,Asterias rubens,https://commons.wikimedia.org/wiki/Special:FilePath/Asterias_rubens.jpg
hadice,Ophiura ophiura,https://commons.wikimedia.org/wiki/Special:FilePath/Ophiura_ophiura.jpg
je≈æovka,Echinus esculentus,https://commons.wikimedia.org/wiki/Special:FilePath/Echinus_esculentus.jpg
mihule potoƒçn√≠,Lampetra planeri,https://commons.wikimedia.org/wiki/Special:FilePath/Lampetra_planeri.jpg
≈æralok,Carcharodon carcharias,https://commons.wikimedia.org/wiki/Special:FilePath/Carcharodon_carcharias.jpg
rejnok,Raja clavata,https://commons.wikimedia.org/wiki/Special:FilePath/Raja_clavata.jpg
≈°tika obecn√°,Esox lucius,https://commons.wikimedia.org/wiki/Special:FilePath/Esox_lucius.jpg
kapr obecn√Ω,Cyprinus carpio,https://commons.wikimedia.org/wiki/Special:FilePath/Cyprinus_carpio.jpg
√∫ho≈ô ≈ô√≠ƒçn√≠,Anguilla anguilla,https://commons.wikimedia.org/wiki/Special:FilePath/Anguilla_anguilla.jpg
pstruh obecn√Ω,Salmo trutta,https://commons.wikimedia.org/wiki/Special:FilePath/Salmo_trutta.jpg
okoun ≈ô√≠ƒçn√≠,Perca fluviatilis,https://commons.wikimedia.org/wiki/Special:FilePath/Perca_fluviatilis.jpg
losos obecn√Ω,Salmo salar,https://commons.wikimedia.org/wiki/Special:FilePath/Salmo_salar.jpg
jeseter velk√Ω,Acipenser sturio,https://commons.wikimedia.org/wiki/Special:FilePath/Acipenser_sturio.jpg
vranka obecn√°,Cottus gobio,https://commons.wikimedia.org/wiki/Special:FilePath/Cottus_gobio.jpg
ropucha obecn√°,Bufo bufo,https://commons.wikimedia.org/wiki/Special:FilePath/Bufo_bufo.jpg
skokan zelen√Ω,Pelophylax esculentus,https://commons.wikimedia.org/wiki/Special:FilePath/Pelophylax_esculentus.jpg
rosniƒçka zelen√°,Hyla arborea,https://commons.wikimedia.org/wiki/Special:FilePath/Hyla_arborea.jpg
ƒçolek velk√Ω,Triturus cristatus,https://commons.wikimedia.org/wiki/Special:FilePath/Triturus_cristatus.jpg
mlok skvrnit√Ω,Salamandra salamandra,https://commons.wikimedia.org/wiki/Special:FilePath/Salamandra_salamandra.jpg
u≈æovka obojkov√°,Natrix natrix,https://commons.wikimedia.org/wiki/Special:FilePath/Natrix_natrix.jpg
zmije obecn√°,Vipera berus,https://commons.wikimedia.org/wiki/Special:FilePath/Vipera_berus.jpg
slep√Ω≈° k≈ôehk√Ω,Anguis fragilis,https://commons.wikimedia.org/wiki/Special:FilePath/Anguis_fragilis.jpg
je≈°tƒõrka obecn√°,Lacerta agilis,https://commons.wikimedia.org/wiki/Special:FilePath/Lacerta_agilis.jpg
≈æelva bahenn√≠,Emys orbicularis,https://commons.wikimedia.org/wiki/Special:FilePath/Emys_orbicularis.jpg
p≈°tros dvouprst√Ω,Struthio camelus,https://commons.wikimedia.org/wiki/Special:FilePath/Struthio_camelus.jpg
kivi ji≈æn√≠,Apteryx australis,https://commons.wikimedia.org/wiki/Special:FilePath/Apteryx_australis.jpg
tuƒç≈à√°k patagonsk√Ω,Aptenodytes patagonicus,https://commons.wikimedia.org/wiki/Special:FilePath/Aptenodytes_patagonicus.jpg
kachna divok√°,Anas platyrhynchos,https://commons.wikimedia.org/wiki/Special:FilePath/Anas_platyrhynchos.jpg
k√°nƒõ lesn√≠,Buteo buteo,https://commons.wikimedia.org/wiki/Special:FilePath/Buteo_buteo.jpg
po≈°tolka obecn√°,Falco tinnunculus,https://commons.wikimedia.org/wiki/Special:FilePath/Falco_tinnunculus.jpg
koroptev poln√≠,Perdix perdix,https://commons.wikimedia.org/wiki/Special:FilePath/Perdix_perdix.jpg
k≈ôepelka poln√≠,Coturnix coturnix,https://commons.wikimedia.org/wiki/Special:FilePath/Coturnix_coturnix.jpg
racek chechtav√Ω,Chroicocephalus ridibundus,https://commons.wikimedia.org/wiki/Special:FilePath/Chroicocephalus_ridibundus.jpg
hrdliƒçka divok√°,Streptopelia turtur,https://commons.wikimedia.org/wiki/Special:FilePath/Streptopelia_turtur.jpg
s√Ωƒçek obecn√Ω,Athene noctua,https://commons.wikimedia.org/wiki/Special:FilePath/Athene_noctua.jpg
kukaƒçka obecn√°,Cuculus canorus,https://commons.wikimedia.org/wiki/Special:FilePath/Cuculus_canorus.jpg
strakapoud velk√Ω,Dendrocopos major,https://commons.wikimedia.org/wiki/Special:FilePath/Dendrocopos_major.jpg
drozd zpƒõvn√Ω,Turdus philomelos,https://commons.wikimedia.org/wiki/Special:FilePath/Turdus_philomelos.jpg
kos ƒçern√Ω,Turdus merula,https://commons.wikimedia.org/wiki/Special:FilePath/Turdus_merula.jpg
ƒçervenka obecn√°,Erithacus rubecula,https://commons.wikimedia.org/wiki/Special:FilePath/Erithacus_rubecula.jpg
slav√≠k obecn√Ω,Luscinia megarhynchos,https://commons.wikimedia.org/wiki/Special:FilePath/Luscinia_megarhynchos.jpg
s√Ωkora ko≈àadra,Parus major,https://commons.wikimedia.org/wiki/Special:FilePath/Parus_major.jpg
vla≈°tovka obecn√°,Hirundo rustica,https://commons.wikimedia.org/wiki/Special:FilePath/Hirundo_rustica.jpg
brhl√≠k lesn√≠,Sitta europaea,https://commons.wikimedia.org/wiki/Special:FilePath/Sitta_europaea.jpg
stehl√≠k obecn√Ω,Carduelis carduelis,https://commons.wikimedia.org/wiki/Special:FilePath/Carduelis_carduelis.jpg
pƒõnkava obecn√°,Fringilla coelebs,https://commons.wikimedia.org/wiki/Special:FilePath/Fringilla_coelebs.jpg
sk≈ôivan poln√≠,Alauda arvensis,https://commons.wikimedia.org/wiki/Special:FilePath/Alauda_arvensis.jpg
konipas b√≠l√Ω,Motacilla alba,https://commons.wikimedia.org/wiki/Special:FilePath/Motacilla_alba.jpg
≈°paƒçek obecn√Ω,Sturnus vulgaris,https://commons.wikimedia.org/wiki/Special:FilePath/Sturnus_vulgaris.jpg
vr√°na obecn√°,Corvus corone,https://commons.wikimedia.org/wiki/Special:FilePath/Corvus_corone.jpg
havran poln√≠,Corvus frugilegus,https://commons.wikimedia.org/wiki/Special:FilePath/Corvus_frugilegus.jpg
ji≈ôiƒçka obecn√°,Delichon urbicum,https://commons.wikimedia.org/wiki/Special:FilePath/Delichon_urbicum.jpg
straka obecn√°,Pica pica,https://commons.wikimedia.org/wiki/Special:FilePath/Pica_pica.jpg
sojka obecn√°,Garrulus glandarius,https://commons.wikimedia.org/wiki/Special:FilePath/Garrulus_glandarius.jpg
ptakopysk podivn√Ω,Ornithorhynchus anatinus,https://commons.wikimedia.org/wiki/Special:FilePath/Ornithorhynchus_anatinus.jpg
je≈æura australsk√°,Tachyglossus aculeatus,https://commons.wikimedia.org/wiki/Special:FilePath/Tachyglossus_aculeatus.jpg
klokan rud√Ω,Macropus rufus,https://commons.wikimedia.org/wiki/Special:FilePath/Macropus_rufus.jpg
je≈æek z√°padn√≠,Erinaceus europaeus,https://commons.wikimedia.org/wiki/Special:FilePath/Erinaceus_europaeus.jpg
krtek obecn√Ω,Talpa europaea,https://commons.wikimedia.org/wiki/Special:FilePath/Talpa_europaea.jpg
rejsek obecn√Ω,Sorex araneus,https://commons.wikimedia.org/wiki/Special:FilePath/Sorex_araneus.jpg
netop√Ωr velk√Ω,Myotis myotis,https://commons.wikimedia.org/wiki/Special:FilePath/Myotis_myotis.jpg
makak rhesus,Macaca mulatta,https://commons.wikimedia.org/wiki/Special:FilePath/Macaca_mulatta.jpg
pavi√°n pl√°≈°t√≠kov√Ω,Papio hamadryas,https://commons.wikimedia.org/wiki/Special:FilePath/Papio_hamadryas.jpg
≈°impanz uƒçenliv√Ω,Pan troglodytes,https://commons.wikimedia.org/wiki/Special:FilePath/Pan_troglodytes.jpg
gorila obecn√°,Gorilla gorilla,https://commons.wikimedia.org/wiki/Special:FilePath/Gorilla_gorilla.jpg
orangutan,Pongo pygmaeus,https://commons.wikimedia.org/wiki/Special:FilePath/Pongo_pygmaeus.jpg
p√°sovec,Dasypus novemcinctus,https://commons.wikimedia.org/wiki/Special:FilePath/Dasypus_novemcinctus.jpg
mraveneƒçn√≠k velik√Ω,Myrmecophaga tridactyla,https://commons.wikimedia.org/wiki/Special:FilePath/Myrmecophaga_tridactyla.jpg
lenochod,Bradypus tridactylus,https://commons.wikimedia.org/wiki/Special:FilePath/Bradypus_tridactylus.jpg
zaj√≠c poln√≠,Lepus europaeus,https://commons.wikimedia.org/wiki/Special:FilePath/Lepus_europaeus.jpg
kr√°l√≠k divok√Ω,Oryctolagus cuniculus,https://commons.wikimedia.org/wiki/Special:FilePath/Oryctolagus_cuniculus.jpg
sysel obecn√Ω,Spermophilus citellus,https://commons.wikimedia.org/wiki/Special:FilePath/Spermophilus_citellus.jpg
krysa obecn√°,Rattus rattus,https://commons.wikimedia.org/wiki/Special:FilePath/Rattus_rattus.jpg
potkan,Rattus norvegicus,https://commons.wikimedia.org/wiki/Special:FilePath/Rattus_norvegicus.jpg
k≈ôeƒçek poln√≠,Cricetus cricetus,https://commons.wikimedia.org/wiki/Special:FilePath/Cricetus_cricetus.jpg
ondatra pi≈æmov√°,Ondatra zibethicus,https://commons.wikimedia.org/wiki/Special:FilePath/Ondatra_zibethicus.jpg
hrabo≈° poln√≠,Microtus arvalis,https://commons.wikimedia.org/wiki/Special:FilePath/Microtus_arvalis.jpg
nutrie ≈ô√≠ƒçn√≠,Myocastor coypus,https://commons.wikimedia.org/wiki/Special:FilePath/Myocastor_coypus.jpg
rys ostrovid,Lynx lynx,https://commons.wikimedia.org/wiki/Special:FilePath/Lynx_lynx.jpg
hyena,Hyaena hyaena,https://commons.wikimedia.org/wiki/Special:FilePath/Hyaena_hyaena.jpg
vlk,Canis lupus,https://commons.wikimedia.org/wiki/Special:FilePath/Canis_lupus.jpg
li≈°ka,Vulpes vulpes,https://commons.wikimedia.org/wiki/Special:FilePath/Vulpes_vulpes.jpg
kuna lesn√≠,Martes martes,https://commons.wikimedia.org/wiki/Special:FilePath/Martes_martes.jpg
lasice hranostaj,Mustela erminea,https://commons.wikimedia.org/wiki/Special:FilePath/Mustela_erminea.jpg
tcho≈ô tmav√Ω,Mustela putorius,https://commons.wikimedia.org/wiki/Special:FilePath/Mustela_putorius.jpg
vydra ≈ô√≠ƒçn√≠,Lutra lutra,https://commons.wikimedia.org/wiki/Special:FilePath/Lutra_lutra.jpg
jezevec lesn√≠,Meles meles,https://commons.wikimedia.org/wiki/Special:FilePath/Meles_meles.jpg
lachtan,Otaria flavescens,https://commons.wikimedia.org/wiki/Special:FilePath/Otaria_flavescens.jpg
delf√≠n obecn√Ω,Delphinus delphis,https://commons.wikimedia.org/wiki/Special:FilePath/Delphinus_delphis.jpg
plejtv√°k my≈°ok,Balaenoptera physalus,https://commons.wikimedia.org/wiki/Special:FilePath/Balaenoptera_physalus.jpg
slon africk√Ω,Loxodonta africana,https://commons.wikimedia.org/wiki/Special:FilePath/Loxodonta_africana.jpg
slon indick√Ω,Elephas maximus,https://commons.wikimedia.org/wiki/Special:FilePath/Elephas_maximus.jpg
osel dom√°c√≠,Equus asinus,https://commons.wikimedia.org/wiki/Special:FilePath/Equus_asinus.jpg
prase divok√©,Sus scrofa,https://commons.wikimedia.org/wiki/Special:FilePath/Sus_scrofa.jpg
jelen evropsk√Ω,Cervus elaphus,https://commons.wikimedia.org/wiki/Special:FilePath/Cervus_elaphus.jpg
danƒõk skvrnit√Ω,Dama dama,https://commons.wikimedia.org/wiki/Special:FilePath/Dama_dama.jpg
srnec obecn√Ω,Capreolus capreolus,https://commons.wikimedia.org/wiki/Special:FilePath/Capreolus_capreolus.jpg
sob pol√°rn√≠,Rangifer tarandus,https://commons.wikimedia.org/wiki/Special:FilePath/Rangifer_tarandus.jpg
zubr evropsk√Ω,Bison bonasus,https://commons.wikimedia.org/wiki/Special:FilePath/Bison_bonasus.jpg
kudu velk√Ω,Tragelaphus strepsiceros,https://commons.wikimedia.org/wiki/Special:FilePath/Tragelaphus_strepsiceros.jpg
kamz√≠k horsk√Ω,Rupicapra rupicapra,https://commons.wikimedia.org/wiki/Special:FilePath/Rupicapra_rupicapra.jpg
muflon,Ovis musimon,https://commons.wikimedia.org/wiki/Special:FilePath/Ovis_musimon.jpg`; // [1]

/* === promƒõnn√© stavu ====================================================== */
const TRANS = 600;   // d√©lka otoƒçen√≠ (ms)
let deck=[], unknown=[], idx=0, round=1, rightCnt=0, wrongCnt=0;

/* === prvky DOM =========================================================== */
const fileInput = document.getElementById('file');
const btnReset  = document.getElementById('btnReset');
const card      = document.getElementById('card');
const inner     = document.getElementById('inner');
const pic       = document.getElementById('pic');
const title     = document.getElementById('title');
const btnW      = document.getElementById('btnWrong');
const btnR      = document.getElementById('btnRight');
const btnAlt    = document.getElementById('btnAlt');
const stats     = document.getElementById('stats');
const ctrl      = document.getElementById('ctrl');

/* === CSV ‚Üí objekty ======================================================= */
function parseCSV(text){
  return text.split(/\r?\n/)
             .filter(l=>l.trim())
             .map(l=>{
               const c = l.split(',');
               const lat = (c[1]||'').trim();
               const img = (c[2]||`https://commons.wikimedia.org/wiki/Special:FilePath/${encodeURIComponent(lat)}.jpg`).trim();
               return {cz:c[0].trim(), latin:lat, img, alt:[], altIdx:0};
             });
}

/* === localStorage ======================================================== */
function save(){ localStorage.setItem('flashProg', JSON.stringify({deck,unknown,idx,round,rightCnt,wrongCnt})); }
function load(){ return JSON.parse(localStorage.getItem('flashProg')||'null'); }
function resetStorage(){ localStorage.removeItem('flashProg'); }

/* === UI ================================================================== */
const updStats = ()=> stats.textContent =
  `Kolo ${round} | Karta ${idx+1}/${deck.length} | ‚úî ${rightCnt} ‚úñ ${wrongCnt}`;

function showCard(){
  inner.classList.remove('flipped');
  const cur = deck[idx];
  pic.src = cur.img;
  title.textContent = cur.cz;
  updStats(); save();
}

function finishRound(){
  alert(`Konec kola ${round}. ‚úî=${rightCnt} ‚úñ=${wrongCnt}`);
  if(unknown.length){
    deck = unknown; unknown=[]; idx=0; round++; rightCnt=wrongCnt=0;
    showCard();
  }else{
    alert('Hotovo ‚Äì v≈°echno zn√°te!');
    card.style.display='none'; ctrl.style.display='none';
    resetStorage();
  }
}

function next(correct){
  correct ? rightCnt++ : wrongCnt++;
  if(!correct) unknown.push(deck[idx]);

  inner.classList.remove('flipped');
  setTimeout(()=>{
    idx++;
    if(idx>=deck.length) finishRound();
    else showCard();
  },TRANS);
}

/* === Wikimedia Commons API ‚Äì nov√© obr√°zky =============================== */
async function fetchAlternatives(card){
  const url = `https://commons.wikimedia.org/w/api.php?action=query&origin=*&format=json`+
              `&generator=search&gsrnamespace=6&gsrlimit=20&gsrsearch=intitle:${encodeURIComponent(card.latin)}`+
              `&prop=imageinfo&iiprop=url`;
  try{
    const j = await fetch(url).then(r=>r.json());
    if(j.query && j.query.pages){
      card.alt = Object.values(j.query.pages)
                       .map(p=>p.imageinfo && p.imageinfo[0].url)
                       .filter(Boolean);
    }
  }catch(e){ console.error(e); }
}

async function changeImage(){
  const cur = deck[idx];
  if(!cur.alt.length){
    await fetchAlternatives(cur);
    if(!cur.alt.length){ alert('Nena≈°el jsem dal≈°√≠ obr√°zek'); return; }
  }
  cur.altIdx = Math.floor(Math.random() * cur.alt.length);
  cur.img = cur.alt[cur.altIdx];
  pic.src = cur.img;
  save();
}

/* === posluchaƒçe ========================================================== */
inner.addEventListener('click',()=>inner.classList.toggle('flipped'));
btnW  .addEventListener('click',()=>next(false));
btnR  .addEventListener('click',()=>next(true));
btnAlt.addEventListener('click',changeImage);

fileInput.addEventListener('change',e=>{
  const f=e.target.files[0]; if(!f) return;
  const r=new FileReader();
  r.onload = ev=>{
    deck = parseCSV(ev.target.result);
    unknown=[]; idx=0; round=1; rightCnt=wrongCnt=0;
    card.style.display='block'; ctrl.style.display='flex';
    showCard();
  };
  r.readAsText(f,'utf-8');
  e.target.value='';
});

btnReset.addEventListener('click',()=>{
  if(confirm('Opravdu zaƒç√≠t znovu?')){
    resetStorage(); init();
  }
});

/* === start =============================================================== */
function init(){
  const saved = load();
  if(saved){
    ({deck,unknown,idx,round,rightCnt,wrongCnt}=saved);
  }else{
    deck = parseCSV(DEFAULT_CSV);
  }
  if(deck.length){
    card.style.display='block'; ctrl.style.display='flex';
    showCard();
  }
}
init();
</script>
</body>
</html>
